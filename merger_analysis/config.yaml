# BYOL + PCA Merger Analysis Configuration
# Clean, well-documented configuration for merger classification pipeline

# Data paths
data:
  input_path: ../../local_data/pieridae_output/starlet/msorabove_v0
  output_path: ../output/

# Model architecture
model:
  image_size: 150
  projection_size: 128
  projection_hidden_size: 1024
  moving_average_decay: 0.99

# Training parameters
training:
  num_epochs: 1000
  batch_size: 1024
  learning_rate: 0.0003
  save_interval: 100
  resume: false

# Inference parameters
inference:
  batch_size: 1024

# Dimensionality reduction
analysis:
  # PCA settings
  pca_components: 10  # null for automatic selection
  explained_variance_threshold: 0.95

  # UMAP settings
  umap_components: 2
  n_neighbors: 15
  min_dist: 0.01
  metric: euclidean

# Label propagation
labels:
  # Classification file
  classifications_file: ../../../quick_projects/vizinspect/scripts/classifications_kadofong_current.csv
  index_column: 0

  # K-NN label propagation
  n_neighbors: 50
  minimum_labeled_neighbors: 5
  minimum_labeled_neighbors_for_autoprop: 15
  prob_threshold: 0.9
  frag_threshold: 0.4

  # Label meanings
  label_mapping:
    0: unclassified
    1: undisturbed
    2: ambiguous
    3: merger
    4: fragmentation
    5: artifact

# Visualization
visualization:
  create_plots: true
  plot_format: png
  dpi: 300
  figsize: [12, 8]

# Logging
logging:
  level: INFO
  console_output: true
  save_logs: true

# Advanced options
advanced:
  random_seed: 28
  deterministic: false
  normalize_images: false
  remove_outliers: false
  clear_cache: true
  low_memory_mode: false

# Cluster-specific settings (for HPC use)
cluster:
  use_scratch: false
  scratch_base: /scratch/gpfs
  conda_env: merenv
  modules:
    - anaconda3/2023.9

  # CPU job settings
  cpu_job:
    nodes: 1
    cpus_per_task: 16
    mem: 128G
    time: '2:00:00'
    partition: cpu

  # GPU job settings
  gpu_job:
    nodes: 1
    cpus_per_task: 8
    gres: gpu:1
    mem: 64G
    time: '4:00:00'
    partition: gpu
